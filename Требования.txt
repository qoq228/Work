Зачем?
Необходимо предоставить стандартный и удобный интерфейс для провайдеров, чтобы они могли самостоятельно интегрироваться с модулем коммуникаций SberCRM. Это позволит:
1.	Сократить время и затраты на настройку новых интеграций
2.	Обеспечить масштабируемость системы за счет унифицированного подхода к подключению провайдеров
3.	Упростить сопровождение и развитие модуля коммуникаций т.к. все интеграции будут работать через единый интерфейс
4.	Повысить удобство работы пользователей, предоставив им доступ к коммуникациям с клиентами через разные каналы в одном интерфейсе

Кейсы применения
1.	Интеграция новых провайдеров коммуникаций: через предоставленный публичный API провайдеры смогут самостоятельно настраивать интеграцию с модулем коммуникаций SberCRM
2.	Обеспечение непрерывности бизнес-коммуникаций: благодаря унифицированному API компании смогут использовать несколько каналов связи одновременно, обеспечивая отказоустойчивость коммуникаций с клиентами
Базовые требования
1.	Я, как разработчик провайдера, хочу иметь единый API для взаимодействия моей системы с модулем коммуникаций SberCRM
2.	Я. как разработчик провайдера, хочу иметь возможность загружать конфигурацию своего API в модуль коммуникаций для настройки двусторонней передачи информации между сервисами
3.	Я, как разработчик провайдера, хочу иметь доступ к документации о публичном API модуля коммуникаций SberCRM
4.	Я, как разработчик провайдера, хочу иметь возможность протестировать интеграцию на тестовом стенде
5.	Я, как администратор SberCRM, хочу иметь возможность протестировать интеграцию на тестовом стенде до ее ввода в промышленную эксплуатацию
6.	Я, как администратор SberCRM, хочу иметь возможность согласовывать интеграции модуля коммуникаций с системой провайдера до их ввода в промышленную эксплуатацию
7.	Я, как пользователь, хочу пользоваться последней версией API после установки приложения провайдера в SberCRM
Дополнительные требования
1.	Опубликовать документацию публичного API для провайдеров на портале разработчика
2.	Добавить в публичный API поддержку следующего функционала:
1.	Форматирование текста сообщения
2.	Редактирование чатов
3.	Групповые чаты
4.	Передача больших объемов информации (Bulk API)
Требования к провайдерам
Провайдеры для интеграции с публичным API модуля коммуникаций SberCRM  должны соответствовать следующим требованиям:
•	На стороне провайдера обязательно должны быть следующие методы:
o	Запрос списка каналов
	Одноканальные провайдеры (Авито и тд) должны возвращать пустой список активных каналов
o	Отправка сообщения
o	Прочтение сообщений в чате
o	Обновление статуса сообщения
o	Отключение приложения в маркетплейсе SberCRM
	Со стороны модуля коммуникаций происходит деактивация токена. Провайдер должен перестать направлять в модуль коммуникаций запросы для этого клиента
•	На стороне провайдера опционально могут быть следующие методы: 
o	Загрузка истории сообщений
o	Пакетная отправка сообщений
o	Установка вебхука
o	Отключение вебхука
•	API методы провайдера должны поддерживать формат данных, заданный модулем коммуникаций SberCRM
•	При регистрации провайдера в модуле коммуникаций, он должен передать список эндпоинтов своего API
•	При регистрации провайдера в модуле коммуникаций должно использоваться системное имя провайдера, заданное в параметрах его приложения в маркетплейсе
•	Провайдер должен предоставить тестовый стенд и учетки для проверки интеграции со стороны модераторов SberCRM перед публикацией приложения в маркетплейсе
•	Файлы должны храниться на серверах провайдера и быть доступны по прямой ссылке
•	Провайдер должен иметь возможность предоставить клиенту токен авторизации для подключения клиента в приложении провайдера в SberCRM
Допущения, ограничения и другие нефункциональные требования
Допущения
1.	Провайдер должен самостоятельно производить маппинг на модель данных модуля коммуникаций на своей стороне
2.	Провайдер должен гарантировать высокую доступность и корректность своих эндпоинтов
Ограничения
1.	Система не предусматривает автоматическую проверку работоспособности интеграции, настроенной провайдером
2.	Чаты не создаются отдельным методом - вся информация о чате и его участниках должна передаваться внутри каждого сообщения
Нефункциональные требования
1.	Производительность
1.	Система должна выдерживать одновременную переписку в кабинете Коммуникаций 25 500 пользователями
2.	Система должна обеспечивать передачу до 800 сообщений в секунду без снижения производительности
3.	Система должна выдерживать требования к производительности модуля коммуникаций относительно передачи файлов, описанные здесь
2.	Безопасность
1.	Методы регистрации и обновления конфигурации провайдера должны быть доступны только провайдеру по токену разработчика
2.	Другие методы публичного API должны использоваться только с токеном клиента 
3.	Все соединения должны производиться с использованием шифрования mTLS
3.	Масштабируемость
1.	Система без значительного снижения производительности должна:
1.	 Поддерживать рост нагрузки до 45 900 одновременных пользователей
2.	Поддерживать рост нагрузки до 1400 сообщений в секунду
3.	Поддерживать рост нагрузки до 250 операций с файлами в час
4.	Поддерживать рост максимального размера передаваемых файлов до 2 Гб
2.	Система должна использовать механизм очередей сообщений для асинхронной обработки нагрузки
4.	Надежность
1.	Система должна обеспечивать уровень доступности публичного API не ниже 99.95% (4.5 часов простоя в год)
2.	Автоматический ретрай: повторение запроса через 5 секунд при отсутствии ответа от провайдера, до 3 попыток
3.	В случае ошибки использования какого-либо метода система должна уведомить пользователя и зафиксировать ошибку в логах
5.	Сопровождение
1.	Система должна предоставлять тестовый стенд для тестирования интеграции провайдером
2.	Система должна логировать все ошибки обращений к публичному API, срок хранения - не менее 30 дней
6.	Отказоустойчивость
1.	В случае недоступности провайдера/канала система должна ставить все отправляемые данные в очередь и отправить их при восстановлении соединения
2.	Если в течение часа информация не была отправлена - система должна убрать эту запись из очереди и пометить как не отправленную
7.	Удобство
1.	Система должна предоставлять удобную и понятную документацию публичного API на портале разработчика SberCRM
2.	Документация публичного API должна поддерживать локализацию SberCRM
3.	Система должна уведомлять провайдеров об обновлениях, чтобы провайдеры могли своевременно обновить интеграцию

